This is not the final version of the code, I provide it for review.
